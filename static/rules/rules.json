[
  {
    "name": "engine-temperature-range",
    "conditions": {
      "any": [
        {
          "fact": "engineTemp",
          "operator": "greaterThan",
          "value": 150
        },
        {
          "fact": "engineTemp",
          "operator": "lessThan",
          "value": -20
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "ENGINE_TEMP",
        "reason": "Engine temperature out of range"
      }
    }
  },
  {
    "name": "engine-overheat",
    "conditions": {
      "all": [
        {
          "fact": "engineTemp",
          "operator": "lessThan",
          "value": 150
        },
        {
          "fact": "engineTemp",
          "operator": "greaterThan",
          "value": 100
        },
        {
          "fact": "avgSpeed",
          "operator": "greaterThan",
          "value": 0
        }
      ]
    },
    "event": {
      "type": "MANUAL_REVIEW",
      "params": {
        "effectedBy": "ENGINE_TEMP",
        "reason": "Possible engine overheating. Check gear and revs"
      }
    }
  },
  {
    "name": "engine-overheat-stationary",
    "conditions": {
      "all": [
        {
          "fact": "engineTemp",
          "operator": "greaterThan",
          "value": 90
        },
        {
          "fact": "avgSpeed",
          "operator": "equal",
          "value": 0
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "ENGINE_TEMP",
        "reason": "Engine temperature rises above 90C while vehicle is stationary. Check your radiator or re-park in the shadow"
      }
    }
  },
  {
    "name": "fule-level-increase",
    "conditions": {
      "any": [
        {
          "fact": "fuelLevelChangeRate",
          "operator": "greaterThan",
          "value": 20
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "FUEL_LEVEL",
        "reason": "Fuel level increase by more than 20% while vechicle is in motion. Are you a fighter jet refueling mid-air?"
      }
    }
  },
  {
    "name": "fuel-leak",
    "conditions": {
      "any": [
        {
          "fact": "fuelLevelChangeRate",
          "operator": "lessThan",
          "value": -20
        }
      ]
    },
    "event": {
      "type": "MANUAL_REVIEW",
      "params": {
        "effectedBy": "FUEL_LEVEL",
        "reason": "Fuel level decreased by more than 20% since last reading. Possible fuel leak"
      }
    }
  },
  {
    "name": "fuel-level-range-rule",
    "conditions": {
      "any": [
        {
          "fact": "fuelLevel",
          "operator": "lessThan",
          "value": 0
        },
        {
          "fact": "fuelLevel",
          "operator": "greaterThan",
          "value": 100
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "FUEL_LEVEL",
        "reason": "Fuel level out of range"
      }
    }
  },
  {
    "name": "fuel-level-change-high-speed-rule",
    "conditions": {
      "all": [
        {
          "fact": "fuelLevelChangeRate",
          "operator": "greaterThan",
          "value": 0
        },
        {
          "fact": "speed",
          "operator": "greaterThanInclusive",
          "value": 120
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "FUEL_LEVEL",
        "reason": "Fuel can't increase in high speeds (unless you're flying a fighter jet refueling mid-air)"
      }
    }
  },
  {
    "name": "speed-range-rule",
    "conditions": {
      "any": [
        {
          "fact": "speed",
          "operator": "greaterThan",
          "value": 200
        },
        {
          "fact": "speed",
          "operator": "lessThan",
          "value": 0
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "SPEED",
        "reason": "Speed out of range"
      }
    }
  },
  {
    "name": "speed-spike",
    "conditions": {
      "all": [
        {
          "fact": "speedChange",
          "operator": "greaterThan",
          "value": 60
        }
      ]
    },
    "event": {
      "type": "MANUAL_REVIEW",
      "params": {
        "effectedBy": "SPEED",
        "reason": "Sudden speed spike"
      }
    }
  },
  {
    "name": "travel-distance-range-rule",
    "conditions": {
      "all": [
        {
          "fact": "distanceTraveledMeters",
          "operator": "greaterThan",
          "value": { "fact": "maxPossibleDistanceMeters" }
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "LOCATION",
        "reason": "Location data out of range. Teleportation is prohibited in this airspace"
      }
    }
  },
  {
    "name": "idle-speed-distance-rule",
    "conditions": {
      "all": [
        {
          "fact": "speed",
          "operator": "equal",
          "value": 0
        },
        {
          "fact": "prevSpeed",
          "operator": "equal",
          "value": 0
        },
        {
          "fact": "distanceTraveledMeters",
          "operator": "notEqual",
          "value": 0
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "LOCATION",
        "reason": "Location change while vehicle is stationary. Teleportation is prohibited in this airspace"
      }
    }
  },
  {
    "name": "timestamp-validity",
    "conditions": {
      "any": [
        {
          "fact": "timestampAgeSec",
          "operator": "greaterThan",
          "value": 30
        },
        {
          "fact": "timestampAgeSec",
          "operator": "lessThan",
          "value": 0
        },
        {
          "fact": "prevTimestamp",
          "operator": "greaterThanInclusive",
          "value": { "fact": "timestamp" }
        }
      ]
    },
    "event": {
      "type": "REJECTED",
      "params": {
        "effectedBy": "TIMESTAMP",
        "reason": "Telemetry timestamp invalid"
      }
    }
  }
]
